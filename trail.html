<!DOCTYPE html> 
<html> 
<script>// example of how to run the app: file:///home/nirb/Desktop/test1.html?place=rehovot
</script>
<head> 
<meta name="viewport" content="initial-scale=1.0, user-scalable=no"/> 
<meta http-equiv="content-type" content="text/html; charset=UTF-8"/> 
<title>בפנים רחובות - חדר בריחה פתוח</title> 

<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=false"></script> 
<script type="text/javascript"> 

var lat
//Get the latitude and the longitude;
function successFunction(position) {
    lat = position.coords.latitude;
    var lng = position.coords.longitude;
    //alert(lat)
    //file:///home/nirb/Desktop/test0.html?place=123
    const queryString = window.location.search;
    const urlParams = new URLSearchParams(queryString);
    const place = urlParams.get('place');
    rad = urlParams.get('rad');	    
    if (rad==null)
       {
    	rad = 50;
       }
	
    document.getElementById("mylat").innerHTML = 'המיקום שלכם הוא: ' + lat + ' ,' + lng;// + '<br>https://www.google.com/maps/@'+lat+','+lng+',19z';

    myurl = window.location.href.substr(0,window.location.href.search("html")+4);

    switch (place) {
	  case 'rehovot':
	    var placelat = 31.895138890168173;
	    	placelng = 34.81117684158573; 
		next = 'rehovotfirsthouse';
	    break;
	  case 'rehovotfirsthouse':
	    var placelat = 31.896045010370027;
	    	placelng = 34.812678855264146; 
		next = 'rehovotrene';
	    break;
	  case 'rehovotrene':
	    var placelat = 31.897240256120433;
	    	placelng = 34.81578298365006; 
		next = 'rehovotsara';
	    break;
	  case 'rehovotsara':
	    var placelat = 31.895667584338433;
	    	placelng = 34.81657259953825; 
		next = 'rehovotbeer2';
	    break;
	  case 'rehovotbeer2':
	    var placelat = 31.89324036929472;
	    	placelng = 34.817793497487955; 
		next = 'rehovotairplane';
	    break;
	  case 'rehovotairplane':
	    var placelat = 31.89357150508238;
	    	placelng = 34.8143536608535; 
		next = 'rehovothurt';
	    break;
	  case 'rehovothurt':
	    var placelat = 31.894229;
	    	placelng = 34.811401; 
		next = 'rehovotfin';
	    alert("הגעתם למיקום האחרון, כל הכבוד, אתם מוזמנים להסתובב ולהכיר יותר טוב את האזור או להתחיל מסלול חדש");
	    break;
	  case 'rehovotfin':
	    var placelat = 31.894229;
	    	placelng = 34.811401; 
		next = 'rehovotfin';
	    break;
	  default:
	    alert("איך הגעתם לפה??? משהו לא בסדר");
	    next = 'error'
	}

    var dist = ((lat-placelat)**2.+(lng-placelng)**2.)**.5*100000.; // gives approx meter

    if (dist<rad)
        {
        document.getElementById("mbar").innerHTML = "near " + dist;
        window.location.href = myurl + "?place="+next+"&rad="+rad;
        }
    else
        {
        document.getElementById("mbar").innerHTML = "אתם קצת רחוקים מהמיקום, נסו שנית ";
        } 

}

function errorFunction(){
    alert("אנחנו לא  מצליחים לאתר את המיקום שלך, נא לבדוק את הגדרות הפלאפון");
}

function pressed() {
    navigator.geolocation.getCurrentPosition(successFunction, errorFunction);
}

function initialize() {
    geocoder = new google.maps.Geocoder();
}

</script> 
</head>  

<body align="right" dir="rtl">
<b> בִּפְנִים - רחובות </b>
<div id="mbar"></div>
<div id="mylat"></div>
<script>
const queryString1 = window.location.search;
const urlParams1 = new URLSearchParams(queryString1);
const mode = urlParams1.get('mode')
if (mode==null)
{
mode = "riddle";
btntext = "בדיקת מיקום";
}
else
{
btntext = "מפה למיקום הבא";
maps="https://www.google.com/maps/dir//31.894705,34.8131871/@31.894705,34.8131871,17z";
}
	
</script>	
<input id="btnnext" type="button" value="בדיקת המיקום" onclick="pressed()">
<br><br>
<div id="youtube"></div>

<script>
const queryString1 = window.location.search;
const urlParams1 = new URLSearchParams(queryString1);	
const place1 = urlParams1.get('place');
const mode = urlParams1.get('mode');
document.getElementById("btnnext").innerHTML="werwer";
	
if (place1=='rehovotfin')
	{
        document.getElementById("mylat").innerHTML = "כל הכבוד, ניצחת את המסלול";
	}
else
	{
        document.getElementById("mylat").innerHTML = "<br>הכנו לכם את כתב החידה למיקום הבא.<br>אתם חושבים שהגעתם למיקום התחנה (עד 50 מטר)? ליחצו על כפתור הבדיקה";
	}
</script>

<script>
//file:///home/nirb/Desktop/test1.html?place=rehovot
const queryString = window.location.search;
const urlParams = new URLSearchParams(queryString);
const place = urlParams.get('place');
switch (place) {
  case 'rehovot':
    var code = "MNQtUN9cBn4";
    break;
  case 'rehovotfirsthouse':
    var code = "C7WFxqulc0U";
    break;
  case 'rehovotrene':
    var code = "Tlo5P51a2Pg";
    break;
  case 'rehovotsara':
    var code = "v4BMXclf6-k";
    break;
  case 'rehovotbeer2':
    var code = "YVPAHE5QYkc";
    break;
  case 'rehovotairplane':
    var code = "v_xu2eWKfZ4";
    break;
  case 'rehovothurt':
    var code = "JAtS34-4A8M";
    break;
  case 'rehovotfin':
    var code = "0gblBX9-YuI";
    break;
  default:
      var code = "l35BuI1bI-4";  // should be youtube on the application or about the error
}
      var ww = window.innerWidth* 0.95
      var wh0 = window.innerHeight *0.95
      var wh = ww * 9 / 16
      if (wh>wh0)
	{ wh = wh0
	  ww = wh * 16 / 9
	}
      vid = '<iframe width='+ww+' height='+wh+' src="https://www.youtube.com/embed/'+code+'" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>';
      document.getElementById("youtube").innerHTML = vid;

</script>

<br>
<br>

אנו ממליצים לטייל עם מדריך אמיתי ולא רק עם האפליקציה, מדריך יוכל לספר לכם מידע מעבר לנאמר בסרטון, לענות לכם על שאלות ועוד.
<br>
המדריכים (בתשלום) של אזור רחובות הם בן השאר:
<br>
אסף 099-9999999
<br>
ישראל 099-9999999
<br><br>

יש לכם הצעות לשיפור? רעיונות לעוד מסלולים? 
<br><a href="https://wa.me/972542236828" target="_blank"> שילחו ווטסאפ </a>

</body> 
</html> 
